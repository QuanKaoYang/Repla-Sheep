!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=307)}({307:function(e,t){function n(e,t,n,r,a,o,l){try{var c=e[o](l),i=c.value}catch(e){return void n(e)}c.done?t(i):Promise.resolve(i).then(r,a)}function r(e){return function(){var t=this,r=arguments;return new Promise((function(a,o){var l=e.apply(t,r);function c(e){n(l,a,o,c,i,"next",e)}function i(e){n(l,a,o,c,i,"throw",e)}c(void 0)}))}}var a;function o(){document.getElementById("use-HL").value=a.useHL,document.getElementById("use-matchcase").checked=a.matchCase,document.getElementById("use-wildcard").checked=a.wildCard,document.getElementById("use-annotator").checked=a.annotator,document.getElementById("xl-scol").value=a.scol,document.getElementById("xl-tcol").value=a.tcol,document.getElementById("xl-header").value=a.xlhead,document.getElementById("tbx-slang").value=a.slang,document.getElementById("tbx-tlang").value=a.tlang}function l(){localStorage.removeItem("myPref"),a={useHL:"null",matchCase:!0,wildCard:!1,annotator:!1,scol:"A",tcol:"B",xlhead:"0",slang:"ja-jp-jp",tlang:"zh-cn",pre1:"",pre2:"",pre3:"",logs:""},o()}function c(e,t){a[t]=e.target.value,localStorage.setItem("myPref",JSON.stringify(a))}function i(e){a[e.target.value]=!a[e.target.value],localStorage.setItem("myPref",JSON.stringify(a))}function u(e){a.pre3=a.pre2,a.pre2=a.pre1,a.pre1=e,localStorage.setItem("myPref",JSON.stringify(a))}function s(){document.getElementById("pref-division").style.display="none",document.getElementById("replacing-division").style.display="none",document.getElementById("replace-division").style.display="block",document.getElementById("show-replace").classList.add("tab-active"),document.getElementById("show-replace").classList.remove("tab-inactive"),document.getElementById("show-preference").classList.add("tab-inactive"),document.getElementById("show-preference").classList.remove("tab-active")}function d(){document.getElementById("replace-division").style.display="none",document.getElementById("replacing-division").style.display="none",document.getElementById("pref-division").style.display="block",document.getElementById("show-replace").classList.add("tab-inactive"),document.getElementById("show-replace").classList.remove("tab-active"),document.getElementById("show-preference").classList.add("tab-active"),document.getElementById("show-preference").classList.remove("tab-inactive")}function m(){document.getElementById("replacing-division").style.display="none",document.getElementById("app").style.display="block"}function p(e){e.stopPropagation(),e.preventDefault()}function f(e){e.stopPropagation(),e.preventDefault()}function g(e){switch(e.name.substr(e.name.length-4,4)){case".csv":y(e,",");break;case".tsv":y(e,"\t");break;case"xlsx":!function(e,t,n,r){x.apply(this,arguments)}(e,a.scol.toUpperCase(),a.tcol.toUpperCase(),Number(a.xlhead));break;case".tbx":!function(e,t,n){E.apply(this,arguments)}(e,a.slang,a.tlang)}}function y(e,t){return v.apply(this,arguments)}function v(){return(v=r(regeneratorRuntime.mark((function e(t,n){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=new FileReader,a=new RegExp("^[0-9_/[\\]]+$"),r.readAsText(t),r.onload=function(){var e=[],o=r.result.replace(/\r?\n/g,"\n");if("\t"!==n){var l=new RegExp(n,"g");o=o.replace(l,"\t")}u(o);var c=o.split("\n"),i=!0,s=!1,d=void 0;try{for(var m,p=c[Symbol.iterator]();!(i=(m=p.next()).done);i=!0){var f=m.value;if(""!==f){var g=f.split("\t");""!==g[0]&&""!==g[1]&&(a.test(g[0])||e.push(f.split("\t")))}}}catch(e){s=!0,d=e}finally{try{i||null==p.return||p.return()}finally{if(s)throw d}}b(e,t.name)};case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(){return(h=r(regeneratorRuntime.mark((function e(t){var n,r,a,o,l,c,i,s,d,m,p,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopPropagation(),t.preventDefault(),""!=(n=document.getElementById("reptext").value.replace(/\r?\n/g,"\n"))){e.next=5;break}return e.abrupt("return");case 5:for(r=new RegExp("^[0-9_/[\\]]+$"),a=[],u(o=n.replace(/::/g,"\t")),l=o.split("\n"),c=!0,i=!1,s=void 0,e.prev=13,d=l[Symbol.iterator]();!(c=(m=d.next()).done);c=!0)""!==(p=m.value)&&""!==(f=p.split("\t"))[0]&&""!==f[1]&&(r.test(f[0])||a.push(p.split("\t")));e.next=21;break;case 17:e.prev=17,e.t0=e.catch(13),i=!0,s=e.t0;case 21:e.prev=21,e.prev=22,c||null==d.return||d.return();case 24:if(e.prev=24,!i){e.next=27;break}throw s;case 27:return e.finish(24);case 28:return e.finish(21);case 29:b(a,"From TextArea");case 30:case"end":return e.stop()}}),e,null,[[13,17,21,29],[22,,24,28]])})))).apply(this,arguments)}function x(){return(x=r(regeneratorRuntime.mark((function e(t,n,r,a){var o,l,c,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=new JSZip,l=[],c=new RegExp("^"+n+"[0-9]+$"),i=new RegExp("^"+r+"[0-9]+$"),o.loadAsync(t).then((function(e){e.folder("xl/").file("sharedStrings.xml").async("string").then((function(n){var r=(new DOMParser).parseFromString(n,"application/xml"),o=[],s=r.getElementsByTagName("si"),d=!0,m=!1,p=void 0;try{for(var f,g=s[Symbol.iterator]();!(d=(f=g.next()).done);d=!0){var y=f.value,v="",h=y.getElementsByTagName("t"),x=!0,E=!1,B=void 0;try{for(var I,w=h[Symbol.iterator]();!(x=(I=w.next()).done);x=!0){var S=I.value;"rPh"!==S.parentNode.localName&&(v+=S.textContent)}}catch(e){E=!0,B=e}finally{try{x||null==w.return||w.return()}finally{if(E)throw B}}o.push(v)}}catch(e){m=!0,p=e}finally{try{d||null==g.return||g.return()}finally{if(m)throw p}}e.folder("xl/worksheets/").file("sheet1.xml").async("string").then((function(e){var n=(new DOMParser).parseFromString(e,"application/xml").getElementsByTagName("row"),r=-1,s=!0,d=!1,m=void 0;try{for(var p,f=n[Symbol.iterator]();!(s=(p=f.next()).done);s=!0){var g=p.value;if(!(++r<a)){var y=g.getElementsByTagName("c"),v=!1,h=!1,x="",E="",B=!0,I=!1,w=void 0;try{for(var S,k=y[Symbol.iterator]();!(B=(S=k.next()).done);B=!0){var P=S.value;if(v&&h)break;var T=P.getAttribute("r");v?h||i.test(T)&&"s"===P.getAttribute("t")&&(E=o[Number(P.firstChild.textContent)],h=!0,l.push([x,E])):c.test(T)&&"s"===P.getAttribute("t")&&(x=o[Number(P.firstChild.textContent)],v=!0)}}catch(e){I=!0,w=e}finally{try{B||null==k.return||k.return()}finally{if(I)throw w}}}}}catch(e){d=!0,m=e}finally{try{s||null==f.return||f.return()}finally{if(d)throw m}}var C="",R=!0,N=!1,O=void 0;try{for(var L,_=l[Symbol.iterator]();!(R=(L=_.next()).done);R=!0){C+=L.value.join("\t")+"\n"}}catch(e){N=!0,O=e}finally{try{R||null==_.return||_.return()}finally{if(N)throw O}}u(C),b(l,t.name)}))}))}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(){return(E=r(regeneratorRuntime.mark((function e(t,n,r){var a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],(o=new FileReader).readAsText(t),o.onload=function(){var e,l=o.result,c=(new DOMParser).parseFromString(l,"application/xml").getElementsByTagName("text")[0].getElementsByTagName("body")[0].getElementsByTagName("termEntry"),i=!0,s=!1,d=void 0;try{for(var m,p=c[Symbol.iterator]();!(i=(m=p.next()).done);i=!0){var f=m.value;e=["",""];var g=f.getElementsByTagName("langSet"),y=!0,v=!1,h=void 0;try{for(var x,E=g[Symbol.iterator]();!(y=(x=E.next()).done);y=!0){var B=x.value;switch(B.getAttribute("xml:lang")){case n:e[0]=B.getElementsByTagName("tig")[0].getElementsByTagName("term")[0].textContent;break;case r:e[1]=B.getElementsByTagName("tig")[0].getElementsByTagName("term")[0].textContent}if(""!==e[0]&&""!==e[1]){a.push(e);break}}}catch(e){v=!0,h=e}finally{try{y||null==E.return||E.return()}finally{if(v)throw h}}}}catch(e){s=!0,d=e}finally{try{i||null==p.return||p.return()}finally{if(s)throw d}}var I="",w=!0,S=!1,k=void 0;try{for(var P,T=a[Symbol.iterator]();!(w=(P=T.next()).done);w=!0){I+=P.value.join("\t")+"\n"}}catch(e){S=!0,k=e}finally{try{w||null==T.return||T.return()}finally{if(S)throw k}}u(I),b(a,t.name)};case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e,t){return B.apply(this,arguments)}function B(){return(B=r(regeneratorRuntime.mark((function e(t,n){var o,l,c,i,u,s,d,m,p,f,g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=t.sort((function(e,t){return e[0].length>t[0].length?-1:e[0].length<t[0].length?1:0})),document.getElementById("processing-mess").innerText="Processing...",document.getElementById("processing-file").innerText=n,document.getElementById("replace-done").disabled="true",l=document.getElementById("term-bd");l.rows[0];)l.deleteRow(0);for(c=!0,i=!1,u=void 0,e.prev=9,s=o[Symbol.iterator]();!(c=(d=s.next()).done);c=!0)m=d.value,p=document.createElement("tr"),f=document.createElement("td"),g=document.createElement("td"),f.textContent=m[0],g.textContent=m[1],p.appendChild(f),p.appendChild(g),l.appendChild(p);e.next=17;break;case 13:e.prev=13,e.t0=e.catch(9),i=!0,u=e.t0;case 17:e.prev=17,e.prev=18,c||null==s.return||s.return();case 20:if(e.prev=20,!i){e.next=23;break}throw u;case 23:return e.finish(20);case 24:return e.finish(17);case 25:document.getElementById("app").style.display="none",document.getElementById("replacing-division").style.display="block",new Promise((function(e){Word.run(function(){var t=r(regeneratorRuntime.mark((function t(n){var r,l,c,i,u,s,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=0;case 1:if(!(r<o.length)){t.next=10;break}return(l=n.document.body.search(o[r][0],{matchCase:a.matchcase,useWildcard:a.wildcard})).load("text"),t.next=6,n.sync();case 6:for(c=0;c<l.items.length;c++)l.items[c].insertText("[_"+String(r)+"_]","Replace");case 7:r++,t.next=1;break;case 10:return t.next=12,n.sync();case 12:i=0;case 13:if(!(i<o.length)){t.next=22;break}return(u=n.document.body.search("[_"+String(i)+"_]",{matchCase:a.matchcase,useWildcard:a.wildcard})).load(["text","font"]),t.next=18,n.sync();case 18:if(u.items.length>0)for(s=a.annotator?"<_"+String(i)+"_>"+o[i][1]+"<_/_>":o[i][1],d="null"===a.useHL?null:a.useHL,c=0;c<u.items.length;c++)u.items[c].insertText(s,"Replace"),u.items[c].font.highlightColor=d;case 19:i++,t.next=13;break;case 22:return t.next=24,n.sync();case 24:e();case 25:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())})).then((function(){document.getElementById("replace-done").disabled="",document.getElementById("processing-mess").innerText="Finished!"}));case 29:case"end":return e.stop()}}),e,null,[[9,13,17,25],[18,,20,24]])})))).apply(this,arguments)}Office.onReady((function(e){e.host===Office.HostType.Word&&Office.context.requirements.isSetSupported("WordApi","1.1")&&(document.getElementById("non-app").style.display="none",document.getElementById("app").style.display="block",document.getElementById("drop-zone").ondragover=f,document.getElementById("drop-zone").ondragenter=p,document.getElementById("drop-zone").ondrop=function(e){return function(e){e.stopPropagation(),e.preventDefault(),g(e.dataTransfer.files[0])}(e)},document.getElementById("select-repfile").onchange=function(e){return function(e){e.stopPropagation(),e.preventDefault(),g(e.target.files[0])}(e)},document.getElementById("from-textarea").onclick=function(e){return function(e){return h.apply(this,arguments)}(e)},document.getElementById("resetPref").onclick=l,document.getElementById("show-replace").onclick=s,document.getElementById("show-preference").onclick=d,document.getElementById("replace-done").onclick=m,document.getElementById("use-HL").onchange=function(e){return c(e,"useHL")},document.getElementById("use-matchcase").onchange=function(e){return i(e)},document.getElementById("use-wildcard").onchange=function(e){return i(e)},document.getElementById("use-annotator").onchange=function(e){return i(e)},document.getElementById("use-previous").onchange=function(e){return function(e){document.getElementById("reptext").value=a[e.target.value]}(e)},document.getElementById("xl-scol").onchange=function(e){return c(e,"scol")},document.getElementById("xl-tcol").onchange=function(e){return c(e,"tcol")},document.getElementById("xl-header").onchange=function(e){return c(e,"xlhead")},document.getElementById("tbx-slang").onchange=function(e){return c(e,"slang")},document.getElementById("tbx-tlang").onchange=function(e){return c(e,"tlang")},a=function(){var e;e=null!==localStorage.getItem("myPref")?JSON.parse(localStorage.getItem("myPref")):{useHL:"null",matchCase:!0,wildCard:!1,annotator:!1,scol:"A",tcol:"B",xlhead:"0",slang:"ja-jp-jp",tlang:"zh-cn",pre1:"",pre2:"",pre3:"",logs:""};return e}(),o())}))}});
//# sourceMappingURL=taskpane.js.map